/*
@Module: Hakikisha NIDA Module
@Author: Ouma Nyang
@License: MIT License: Copyright (c) 2019 - 2024
*/
$((function(){"use strict";$("#nida_number").mask("00000000 00000 00000 00");class HakikishaNIDA{constructor(){this.bearerToken="token_here";this.spinner=`\n    <div class="spinner-grow text-primary" role="status">\n        <span class="visually-hidden">Loading...</span>\n    </div>`;this.submitButton=$('form button[type="submit"]')}HakikishaNIDA(nida_number){this.submitButton.attr("disabled",true);$.ajax({url:"app/controller/app_controller",method:"POST",headers:{Authorization:`Bearer ${this.bearerToken}`},data:{verify_nida_nin:nida_number},dataType:"JSON",success:response=>{this.submitButton.attr("disabled",false);if(response.success&&response.data!==null){let data=response.data;$("#nida_response").html(`\n                <div class="card border-success border border-2">\n                <div class="card-body text-start">\n                <h6 class="card-title text-success"> ${response.message}</h6>\n                <p><strong>First Name:</strong> ${data.FIRSTNAME}</p>\n                <p><strong>Middle Name:</strong> ${data.MIDDLENAME}</p>\n                <p><strong>Last Name:</strong> ${data.SURNAME}</p>\n                <p><strong>Nationality:</strong> ${data.NATIONALITY}</p>\n                <p><strong>Sex:</strong> ${data.SEX}</p>\n                <p><strong>Date of Birth:</strong> ${data.DATEOFBIRTH}</p>\n                <p><strong>NIN:</strong> ${data.NIN}</p>\n                </div>  \n                </div>  \n\n            `)}else{$("#nida_response").html(`\n                <div class="alert alert-danger">NIDA verification failed: ${response.message}</div>\n            `)}},error:(xhr,status,error)=>{this.submitButton.attr("disabled",false);$("#nida_response").html(`\n            <div class="alert alert-danger">Error: ${error}</div>\n        `)}})}init(){$("#nidaForm").on("submit",(e=>{e.preventDefault();const nida_number=$("#nida_number").val();this.submitButton.attr("disabled",true);$("#nida_response").html(this.spinner);if(nida_number){this.HakikishaNIDA(nida_number)}else{this.submitButton.attr("disabled",false);$("#nida_response").html(`\n            <div class="alert alert-warning">Please enter a NIDA number.</div>\n        `)}}))}}(new HakikishaNIDA).init()}));